<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn to Code - Bug Hunter</title>
    <style>
        :root {
            --bg-color: #f9fafb;
            --card-bg: #ffffff;
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --text-main: #111827;
            --text-sec: #6b7280;
            --success: #059669;
            --error: #dc2626;
            --border-color: #e5e7eb;
            --code-bg: #1e1e1e; /* VS Code Dark */
            --line-hover: #2a2d2e;
        }
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

        header {
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 24px;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            z-index: 100;
        }
        .back-btn {
            background: none;
            border: none;
            color: var(--text-sec);
            padding: 8px;
            margin: -8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: pointer;
            transition: color 0.2s;
            border-radius: 4px;
        }
        .back-btn:hover {
            color: var(--text-main);
            background-color: #f3f4f6;
        }
        
        .status-badge {
            background-color: #eff6ff;
            color: var(--primary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid #dbeafe;
        }
        .status-badge.complete {
            background-color: #ecfdf5;
            color: var(--success);
            border-color: #d1fae5;
        }

        main {
            flex: 1;
            padding: 32px 24px;
            overflow-y: auto;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        h1 {
            font-size: 24px;
            margin: 0;
            font-weight: 600;
            color: var(--text-main);
            letter-spacing: -0.025em;
        }
        p {
            line-height: 1.6;
            color: var(--text-sec);
            margin: 0;
            font-size: 16px;
        }

        /* Editor Window */
        .editor-window {
            background-color: var(--code-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            display: flex;
            flex-direction: column;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 15px;
        }

        .editor-header {
            background-color: #252526;
            padding: 10px 16px;
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .window-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        .dot-red { background-color: #ff5f56; }
        .dot-yellow { background-color: #ffbd2e; }
        .dot-green { background-color: #27c93f; }
        
        .filename {
            color: #9ca3af;
            font-size: 13px;
            margin-left: 12px;
        }

        .code-area {
            padding: 16px 0;
            color: #d4d4d4;
            line-height: 1.6;
        }

        .code-line {
            display: flex;
            padding: 2px 0;
            cursor: pointer;
            transition: background-color 0.1s;
            position: relative;
        }
        .code-line:hover {
            background-color: var(--line-hover);
        }
        
        .line-num {
            width: 40px;
            text-align: right;
            padding-right: 16px;
            color: #858585;
            user-select: none;
            font-size: 13px;
        }
        
        .line-content {
            flex: 1;
            padding-right: 16px;
            white-space: pre;
        }

        /* Syntax Highlighting */
        .kwd { color: #569cd6; } /* Blue */
        .str { color: #ce9178; } /* Orange */
        .num { color: #b5cea8; } /* Light Green */
        .func { color: #dcdcaa; } /* Yellow */
        .var { color: #9cdcfe; } /* Light Blue */
        .comment { color: #6a9955; } /* Green */

        /* Bug States */
        .bug-found {
            background-color: rgba(220, 38, 38, 0.2) !important;
            animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        .bug-fixed {
            background-color: rgba(5, 150, 105, 0.2) !important;
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Tooltip */
        .bug-tooltip {
            position: absolute;
            left: 50%;
            bottom: 100%;
            transform: translateX(-50%);
            background-color: #1f2937;
            color: white;
            padding: 12px;
            border-radius: 6px;
            width: 240px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            z-index: 10;
            display: none;
            text-align: center;
            border: 1px solid #374151;
        }
        .bug-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -6px;
            border-width: 6px;
            border-style: solid;
            border-color: #1f2937 transparent transparent transparent;
        }
        
        .tooltip-title {
            font-weight: 600;
            color: #f87171;
            margin-bottom: 4px;
            display: block;
        }
        .tooltip-desc {
            font-size: 13px;
            color: #d1d5db;
            margin-bottom: 8px;
            display: block;
        }
        .fix-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            width: 100%;
        }
        .fix-btn:hover { background-color: var(--primary-hover); }

        /* Success Overlay */
        .success-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        .success-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .success-icon {
            font-size: 64px;
            margin-bottom: 16px;
            color: var(--success);
        }
        .success-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-main);
            margin-bottom: 8px;
        }
        .success-btn {
            margin-top: 24px;
            padding: 12px 24px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
        }

    </style>
</head>
<body>
    <header>
        <button class="back-btn" onclick="window.location.href='five.html'">←</button>
        <div style="flex:1"></div>
        <div class="status-badge" id="statusBadge">0 / 3 Bugs Fixed</div>
    </header>

    <main>
        <div>
            <h1>Bug Hunter</h1>
            <p>You are reviewing a junior developer's code. Click on the lines that contain errors to fix them.</p>
        </div>

        <div class="editor-window">
            <div class="editor-header">
                <div class="window-dot dot-red"></div>
                <div class="window-dot dot-yellow"></div>
                <div class="window-dot dot-green"></div>
                <span class="filename">weather_app.py</span>
            </div>
            <div class="code-area" id="codeArea">
                <!-- Lines injected by JS -->
            </div>
        </div>
    </main>

    <div class="success-overlay" id="successOverlay">
        <div class="success-icon">✓</div>
        <div class="success-title">Code Review Complete!</div>
        <p>You found all the bugs. The code is now clean.</p>
        <button class="success-btn" onclick="window.location.href='one.html'">Back to Menu</button>
    </div>

    <script>
        // The Code Data
        // We render the "bad" version initially.
        const codeLines = [
            { id: 1, html: '<span class="kwd">def</span> <span class="func">check_weather</span>(temp):', indent: 0 },
            { id: 2, html: '<span class="kwd">if</span> temp > <span class="num">30</span>', indent: 1, bug: { type: 'SyntaxError', title: 'Syntax Error', desc: 'Missing colon at end of if statement.', fixedHtml: '<span class="kwd">if</span> temp > <span class="num">30</span>:' } },
            { id: 3, html: '<span class="kwd">print</span>(<span class="str">"It is hot outside!"</span>)', indent: 2 },
            { id: 4, html: '<span class="kwd">elif</span> temp < <span class="num">10</span>:', indent: 1 },
            { id: 5, html: '<span class="kwd">print</span>(<span class="str">"It is cold!"</span>)', indent: 2 },
            { id: 6, html: '<span class="kwd">else</span>:', indent: 1 },
            { id: 7, html: '<span class="kwd">print</span>(<span class="str">"It is moderate."</span>)', indent: 1, bug: { type: 'IndentationError', title: 'Indentation Error', desc: 'Code inside else block must be indented.', fixedHtml: '<span class="kwd">print</span>(<span class="str">"It is moderate."</span>)', fixedIndent: 2 } },
            { id: 8, html: '', indent: 0 },
            { id: 9, html: '<span class="var">current_temp</span> = <span class="num">25</span>', indent: 0 },
            { id: 10, html: '<span class="func">check_weather</span>(<span class="var">curent_temp</span>)', indent: 0, bug: { type: 'NameError', title: 'Name Error', desc: 'Variable "curent_temp" is not defined. Typo?', fixedHtml: '<span class="func">check_weather</span>(<span class="var">current_temp</span>)' } }
        ];

        let bugsFixed = 0;
        const totalBugs = 3;

        function init() {
            const container = document.getElementById('codeArea');
            
            codeLines.forEach((line, index) => {
                const div = document.createElement('div');
                div.className = 'code-line';
                div.id = `line-${index}`;
                
                // Indentation
                const indentSpaces = '    '.repeat(line.indent);
                
                div.innerHTML = `
                    <div class="line-num">${index + 1}</div>
                    <div class="line-content">${indentSpaces}${line.html}</div>
                `;

                div.onclick = (e) => handleLineClick(index, div, e);
                container.appendChild(div);
            });
        }

        function handleLineClick(index, element, event) {
            const lineData = codeLines[index];
            
            // Remove existing tooltips
            document.querySelectorAll('.bug-tooltip').forEach(el => el.remove());

            if (lineData.bug && !lineData.fixed) {
                // It's a bug!
                element.classList.add('bug-found');
                
                // Create Tooltip
                const tooltip = document.createElement('div');
                tooltip.className = 'bug-tooltip';
                tooltip.style.display = 'block';
                tooltip.innerHTML = `
                    <span class="tooltip-title">${lineData.bug.title}</span>
                    <span class="tooltip-desc">${lineData.bug.desc}</span>
                    <button class="fix-btn">Fix Issue</button>
                `;
                
                // Position tooltip
                element.appendChild(tooltip);
                
                // Handle Fix
                const btn = tooltip.querySelector('.fix-btn');
                btn.onclick = (e) => {
                    e.stopPropagation(); // Prevent re-triggering line click
                    fixBug(index, element);
                };

            } else if (!lineData.fixed) {
                // Not a bug, just shake slightly or flash grey to indicate "nothing here"
                // For now, just console log or subtle visual
                element.style.backgroundColor = '#2a2d2e';
                setTimeout(() => element.style.backgroundColor = '', 200);
            }
        }

        function fixBug(index, element) {
            const lineData = codeLines[index];
            
            // Update Data
            lineData.fixed = true;
            bugsFixed++;
            
            // Update UI Content
            const contentDiv = element.querySelector('.line-content');
            const indentSpaces = '    '.repeat(lineData.bug.fixedIndent !== undefined ? lineData.bug.fixedIndent : lineData.indent);
            contentDiv.innerHTML = `${indentSpaces}${lineData.bug.fixedHtml}`;
            
            // Update UI State
            element.classList.remove('bug-found');
            element.classList.add('bug-fixed');
            element.querySelector('.bug-tooltip').remove();
            
            // Update Status
            const badge = document.getElementById('statusBadge');
            badge.textContent = `${bugsFixed} / ${totalBugs} Bugs Fixed`;
            
            if (bugsFixed === totalBugs) {
                badge.classList.add('complete');
                setTimeout(() => {
                    document.getElementById('successOverlay').classList.add('visible');
                    // Fire confetti if we had the library loaded, but we'll stick to the overlay
                }, 500);
            }
        }

        init();
    </script>
</body>
</html>